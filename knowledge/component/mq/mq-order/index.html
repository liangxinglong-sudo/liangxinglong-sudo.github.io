<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.20" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><meta property="og:url" content="https://liangxinglong-sudo.github.io/knowledge/component/mq/mq-order/"><meta property="og:site_name" content="coder liang"><meta property="og:title" content="如何保证消息有序"><meta property="og:description" content="如何保证有序 要保证顺序消息，首先要，先让生产者发送的消息是有序的。再然后，要保证消费消息是有序的。 那么如何保证生产者发送消息有序？ RocketMQ 中消息发送的 3 种方式：同步、异步、单向。要保证发送消息的顺序，只能保证同步发送，且必须是单个生产者。 其次，利用队列的FIFO特性，保证需要顺序消费的消息在同一个队列里，且只有一个消费者消费。 全..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="tools"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"如何保证消息有序","image":[""],"dateModified":null,"author":[]}</script><link rel="icon" type="image/png" href="https://theme-plume.vuejs.press/favicon-32x32.png"><title>如何保证消息有序 | coder liang</title><meta name="description" content="如何保证有序 要保证顺序消息，首先要，先让生产者发送的消息是有序的。再然后，要保证消费消息是有序的。 那么如何保证生产者发送消息有序？ RocketMQ 中消息发送的 3 种方式：同步、异步、单向。要保证发送消息的顺序，只能保证同步发送，且必须是单个生产者。 其次，利用队列的FIFO特性，保证需要顺序消费的消息在同一个队列里，且只有一个消费者消费。 全..."><link rel="preload" href="/assets/style-YYi87o8u.css" as="style"><link rel="stylesheet" href="/assets/style-YYi87o8u.css"><link rel="modulepreload" href="/assets/app-BN15cZ7s.js"><link rel="modulepreload" href="/assets/index.html-o1RxFqXb.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-e2a85a92><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0d85e7f4></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-0d85e7f4> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-e2a85a92 data-v-e2eaa4d4><div class="vp-navbar" vp-navbar data-v-e2eaa4d4 data-v-d72d6f9b><div class="wrapper" data-v-d72d6f9b><div class="container" data-v-d72d6f9b><div class="title" data-v-d72d6f9b><div class="vp-navbar-title has-sidebar" data-v-d72d6f9b data-v-205b69c8><a class="vp-link no-icon link title" href="/" data-v-205b69c8 data-v-8faef36c><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-f4386e50><!--]--><!--[--><img class="vp-image light logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-f4386e50><!--]--><!--]--><!--]--><span data-v-205b69c8>coder liang</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-d72d6f9b><div class="content-body" data-v-d72d6f9b><!--[--><!--]--><div class="vp-navbar-search search" data-v-d72d6f9b><div class="search-wrapper" data-v-c59534bd><!----><div id="local-search" data-v-c59534bd><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-c59534bd><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-d72d6f9b data-v-a16403a0><span id="main-nav-aria-label" class="visually-hidden" data-v-a16403a0>Main Navigation</span><!--[--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/" tabindex="0" data-v-a16403a0 data-v-e9a2a996 data-v-8faef36c><!--[--><span class="vp-icon vpi-5e10ahoy" style="" data-v-e9a2a996 data-v-741d51ad></span><span data-v-e9a2a996>首页</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/knowledge/java/collection/" tabindex="0" data-v-a16403a0 data-v-e9a2a996 data-v-8faef36c><!--[--><span class="vp-icon vpi-lnpam7xf" style="" data-v-e9a2a996 data-v-741d51ad></span><span data-v-e9a2a996>练级</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/bookmark/" tabindex="0" data-v-a16403a0 data-v-e9a2a996 data-v-8faef36c><!--[--><span class="vp-icon vpi-g2zh3cse" style="" data-v-e9a2a996 data-v-741d51ad></span><span data-v-e9a2a996>优秀文章收藏</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/notes/utils/log/" tabindex="0" data-v-a16403a0 data-v-e9a2a996 data-v-8faef36c><!--[--><span class="vp-icon vpi-zl21d8ra" style="" data-v-e9a2a996 data-v-741d51ad></span><span data-v-e9a2a996>工具类备份</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/notes/storys/view/" tabindex="0" data-v-a16403a0 data-v-e9a2a996 data-v-8faef36c><!--[--><span class="vp-icon vpi-t2pt6g06" style="" data-v-e9a2a996 data-v-741d51ad></span><span data-v-e9a2a996>故事会</span><!--]--><!----></a><!--]--><!--]--></nav><!----><div class="vp-navbar-appearance appearance" data-v-d72d6f9b data-v-51d4779e><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-51d4779e data-v-ecae5613 data-v-58c1d8b1><span class="check" data-v-58c1d8b1><span class="icon" data-v-58c1d8b1><!--[--><span class="vpi-sun sun" data-v-ecae5613></span><span class="vpi-moon moon" data-v-ecae5613></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-d72d6f9b data-v-35aa5044 data-v-65bc2351><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-65bc2351 data-v-04728ed0><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-d72d6f9b data-v-9fcd43db data-v-fdb558f8><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-fdb558f8><span class="vpi-more-horizontal icon" data-v-fdb558f8></span></button><div class="menu" data-v-fdb558f8><div class="vp-menu" data-v-fdb558f8 data-v-b3129113><!----><!--[--><!--[--><!----><div class="group" data-v-9fcd43db><div class="item appearance" data-v-9fcd43db><p class="label" data-v-9fcd43db>外观</p><div class="appearance-action" data-v-9fcd43db><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-9fcd43db data-v-ecae5613 data-v-58c1d8b1><span class="check" data-v-58c1d8b1><span class="icon" data-v-58c1d8b1><!--[--><span class="vpi-sun sun" data-v-ecae5613></span><span class="vpi-moon moon" data-v-ecae5613></span><!--]--></span></span></button></div></div></div><div class="group" data-v-9fcd43db><div class="item social-links" data-v-9fcd43db><div class="vp-social-links social-links-list" data-v-9fcd43db data-v-65bc2351><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-65bc2351 data-v-04728ed0><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-d72d6f9b data-v-d5861cf2><span class="container" data-v-d5861cf2><span class="top" data-v-d5861cf2></span><span class="middle" data-v-d5861cf2></span><span class="bottom" data-v-d5861cf2></span></span></button></div></div></div></div><div class="divider" data-v-d72d6f9b><div class="divider-line" data-v-d72d6f9b></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-e2a85a92 data-v-d3ed9cc5><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-d3ed9cc5><span class="vpi-align-left menu-icon" data-v-d3ed9cc5></span><span class="menu-text" data-v-d3ed9cc5>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-d3ed9cc5 data-v-f17542da><button data-v-f17542da>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-e2a85a92 data-v-dbadda69><div class="curtain" data-v-dbadda69></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-dbadda69><span id="sidebar-aria-label" class="visually-hidden" data-v-dbadda69> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-3e83e6e6><section class="vp-sidebar-item sidebar-item level-0" data-v-3e83e6e6 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-yega0ke4 bg" style="" data-v-584f9df0 data-v-741d51ad></span><h2 class="text" data-v-584f9df0>Java基础</h2><!----></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-tcc4xlqk" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/java/collection/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Collection</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-vnny08jr" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/java/stream/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Stream</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-3e83e6e6><section class="vp-sidebar-item sidebar-item level-0" data-v-3e83e6e6 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-1acq3w1t bg" style="" data-v-584f9df0 data-v-741d51ad></span><h2 class="text" data-v-584f9df0>常用框架</h2><!----></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-j0f033dm" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/frame/spring/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Spring</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-70jov196" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/frame/mybatisPlus/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Mybatis-Plus</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-jxieo9ck" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/frame/springRetry/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>SpringRetry</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-vy1gunrc" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/frame/netty/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Netty</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-tqsssbcu" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/frame/redission/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Redisson</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-3e83e6e6><section class="vp-sidebar-item sidebar-item level-0" data-v-3e83e6e6 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ngv5av0c bg" style="" data-v-584f9df0 data-v-741d51ad></span><h2 class="text" data-v-584f9df0>并发编程</h2><!----></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-f4lkdv9r" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/concurrent/thread/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Java 中的线程</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ej7ppukc" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/concurrent/thread-safe/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>线程安全</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-sm8qgeog" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/concurrent/lock/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Java 中的各种锁</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-mr302uhp" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/concurrent/juc/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>JUC 并发编程</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-3e83e6e6><section class="vp-sidebar-item sidebar-item level-0" data-v-3e83e6e6 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-3b4jgn7q bg" style="" data-v-584f9df0 data-v-741d51ad></span><h2 class="text" data-v-584f9df0>数据库</h2><!----></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-h5lrs786" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/mysql/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>MySQL</p><!--]--><!----></a><!----></div><!----></div><section class="vp-sidebar-item sidebar-item level-1 collapsible collapsed" data-v-584f9df0 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ay78n7gg" style="" data-v-584f9df0 data-v-741d51ad></span><h3 class="text" data-v-584f9df0>Oracle</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-584f9df0><span class="vpi-chevron-right caret-icon" data-v-584f9df0></span></div></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ay78n7gg" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/oracle/oracle/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>入门及概念</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ex5obyuo" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/oracle/oracle-ddl/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>表操作语句</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ex5obyuo" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/oracle/oracle-dql/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>查询语句及函数</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ex5obyuo" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/oracle/oracle-plsql/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>sql编程</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-rk88hxor" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/redis/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Redis</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-9e5u0nio" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dbs/transcation/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>数据库事务</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-3e83e6e6><section class="vp-sidebar-item sidebar-item level-0 has-active" data-v-3e83e6e6 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-uevdl13j bg" style="" data-v-584f9df0 data-v-741d51ad></span><h2 class="text" data-v-584f9df0>开发组件</h2><!----></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-r3bnzrqn" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/docker/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>Docker 容器</p><!--]--><!----></a><!----></div><!----></div><section class="vp-sidebar-item sidebar-item level-1 collapsible has-active" data-v-584f9df0 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-fdp8c6hy" style="" data-v-584f9df0 data-v-741d51ad></span><h3 class="text" data-v-584f9df0>消息队列</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-584f9df0><span class="vpi-chevron-right caret-icon" data-v-584f9df0></span></div></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-fdp8c6hy" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/mq/mq/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>消息队列入门介绍</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-9nsm4wmr" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/mq/mq-noLess/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>如何保证消息不丢失</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-46faplj3" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/mq/mq-noMore/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>如何处理重复消息</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-swpqnx20" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/mq/mq-order/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>如何保证消息有序</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-8qhxwwuv" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/mq/mq-backlog/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>消息积压怎么办</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-6von3p23" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/mq/mq-diy/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>如何写个消息中间件</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="vp-sidebar-item sidebar-item level-1 collapsible collapsed" data-v-584f9df0 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-hz5xqryq" style="" data-v-584f9df0 data-v-741d51ad></span><h3 class="text" data-v-584f9df0>分布式搜索</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-584f9df0><span class="vpi-chevron-right caret-icon" data-v-584f9df0></span></div></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-nkyiwbkf" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/es/es/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>搜索入门介绍</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-buftoowi" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/es/es-install/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>安装 ElasticSearch</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-6x45rwie" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/es/inverted-index/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>什么是倒排索引</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-15gkgb60" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/component/es/get-start/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>如何使用 ElasticSearch</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-3e83e6e6><section class="vp-sidebar-item sidebar-item level-0" data-v-3e83e6e6 data-v-584f9df0><div class="item" role="button" tabindex="0" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-cjrwvuvx bg" style="" data-v-584f9df0 data-v-741d51ad></span><h2 class="text" data-v-584f9df0>数据结构</h2><!----></div><div class="items" data-v-584f9df0><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-weo9eo8m" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dataStructure/array/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>array</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-ho7sg0b0" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dataStructure/chain/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>chain</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-mja81q7x" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dataStructure/stack/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>stack</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-584f9df0 data-v-584f9df0><div class="item" data-v-584f9df0><div class="indicator" data-v-584f9df0></div><span class="vp-icon vpi-0zj85gxk" style="" data-v-584f9df0 data-v-741d51ad></span><a class="vp-link no-icon link link" href="/knowledge/dataStructure/tree/" data-v-584f9df0 data-v-8faef36c><!--[--><p class="text" data-v-584f9df0>tree</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-e2a85a92 data-v-f680e952><div class="vp-doc-container has-sidebar has-aside" data-v-f680e952 data-v-0c1b0d40><!--[--><!--]--><div class="container" data-v-0c1b0d40><div class="aside" vp-outline data-v-0c1b0d40><div class="aside-curtain" data-v-0c1b0d40></div><div class="aside-container" data-v-0c1b0d40><div class="aside-content" data-v-0c1b0d40><div class="vp-doc-aside" data-v-0c1b0d40 data-v-7f9316c5><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-7f9316c5 data-v-1deb207d><div class="content" data-v-1deb207d><div class="outline-marker" data-v-1deb207d></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-1deb207d><span data-v-1deb207d>此页内容</span><span class="vpi-print icon" data-v-1deb207d></span></div><ul class="root" data-v-1deb207d data-v-6af2c33d><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-7f9316c5></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-0c1b0d40><div class="content-container" data-v-0c1b0d40><!--[--><!--]--><main class="main" data-v-0c1b0d40><nav class="vp-breadcrumb" data-v-0c1b0d40 data-v-f0ee12f5><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-f0ee12f5><!--[--><li property="itemListElement" typeof="ListItem" data-v-f0ee12f5><a class="vp-link no-icon link breadcrumb" href="/" property="item" typeof="WebPage" data-v-f0ee12f5 data-v-8faef36c><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-f0ee12f5></span><meta property="name" content="首页" data-v-f0ee12f5><meta property="position" content="1" data-v-f0ee12f5></li><li property="itemListElement" typeof="ListItem" data-v-f0ee12f5><span class="vp-link no-icon breadcrumb" href="/" property="item" typeof="WebPage" data-v-f0ee12f5 data-v-8faef36c><!--[-->开发组件<!--]--><!----></span><span class="vpi-chevron-right" data-v-f0ee12f5></span><meta property="name" content="开发组件" data-v-f0ee12f5><meta property="position" content="2" data-v-f0ee12f5></li><li property="itemListElement" typeof="ListItem" data-v-f0ee12f5><span class="vp-link no-icon breadcrumb" href="/" property="item" typeof="WebPage" data-v-f0ee12f5 data-v-8faef36c><!--[-->消息队列<!--]--><!----></span><span class="vpi-chevron-right" data-v-f0ee12f5></span><meta property="name" content="消息队列" data-v-f0ee12f5><meta property="position" content="3" data-v-f0ee12f5></li><li property="itemListElement" typeof="ListItem" data-v-f0ee12f5><a class="vp-link no-icon link breadcrumb current" href="/knowledge/component/mq/mq-order/" property="item" typeof="WebPage" data-v-f0ee12f5 data-v-8faef36c><!--[-->如何保证消息有序<!--]--><!----></a><!----><meta property="name" content="如何保证消息有序" data-v-f0ee12f5><meta property="position" content="4" data-v-f0ee12f5></li><!--]--></ol></nav><!--[--><h1 class="vp-doc-title page-title" data-v-48e8bd66>如何保证消息有序 <!----></h1><div class="vp-doc-meta" data-v-48e8bd66><p class="reading-time" data-v-48e8bd66><span class="vpi-books icon" data-v-48e8bd66></span><span data-v-48e8bd66>约 405 字</span><span data-v-48e8bd66>大约 1 分钟</span></p><!----><p class="create-time" data-v-48e8bd66><span class="vpi-clock icon" data-v-48e8bd66></span><span data-v-48e8bd66>2025-04-10</span></p></div><!--]--><div class="_knowledge_component_mq_mq-order_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-0c1b0d40><div data-v-0c1b0d40><h2 id="如何保证有序" tabindex="-1"><a class="header-anchor" href="#如何保证有序"><span>如何保证有序</span></a></h2><p>要保证顺序消息，首先要，先让生产者<strong>发送的消息是有序</strong>的。再然后，要保证<strong>消费消息是有序</strong>的。</p><p><strong>那么如何保证生产者发送消息有序？</strong></p><p>RocketMQ 中消息发送的 3 种方式：同步、异步、单向。要保证发送消息的顺序，只能保证<strong>同步发送</strong>，且必须是<strong>单个生产者</strong>。</p><p>其次，利用队列的<code>FIFO</code>特性，保证需要顺序消费的消息在同一个队列里，且只有<strong>一个消费者消费</strong>。</p><h2 id="全局有序" tabindex="-1"><a class="header-anchor" href="#全局有序"><span>全局有序</span></a></h2><p>如果要保证消息的全局有序，首先只能由一个生产者往 <code>Topic</code> 发送消息，并且一个 <code>Topic</code> 内部只能有 一个队列（分区）。消费者也必须是单线程消费这个队列。这样的消息就是全局有序的！</p><p>不过一般情况下我们都不需要全局有序，即使是同步 <code>MySQL Binlog</code> 也只需要保证单表消息有序即可。</p><p><img src="/assets/mq-order-1-vJTco2XS.png" alt="全局有序" width="1053" height="209"></p><h2 id="部分有序" tabindex="-1"><a class="header-anchor" href="#部分有序"><span>部分有序</span></a></h2><p>一个生产者也可以，只要同类消息发往指定的队列即可</p><p><img src="/assets/mq-order-2-DS6Wr4P_.png" alt="部分有序" width="1111" height="387"></p><p>将<code>Topic</code>内部划分为我们需要的队列数，消息通过特定的策略发往固定的队列中，每个队列对应一个单线程处理的消费者，这样完成了部分有序的需求，又可以通过队列数量的并发提高消息处理效率。</p></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-0c1b0d40 data-v-ed4033a5><!--[--><!--]--><!----><!----><nav class="prev-next" data-v-ed4033a5><div class="pager" data-v-ed4033a5><a class="vp-link no-icon link pager-link prev" href="/knowledge/component/mq/mq-noMore/" data-v-ed4033a5 data-v-8faef36c><!--[--><span class="desc" data-v-ed4033a5>上一页</span><span class="title" data-v-ed4033a5>如何处理重复消息</span><!--]--><!----></a></div><div class="pager" data-v-ed4033a5><a class="vp-link no-icon link pager-link next" href="/knowledge/component/mq/mq-backlog/" data-v-ed4033a5 data-v-8faef36c><!--[--><span class="desc" data-v-ed4033a5>下一页</span><span class="title" data-v-ed4033a5>消息积压怎么办</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-e2a85a92 data-v-f652afe6><span class="percent" data-allow-mismatch data-v-f652afe6>0%</span><span class="show icon vpi-back-to-top" data-v-f652afe6></span><svg aria-hidden="true" data-v-f652afe6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-f652afe6></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-e2a85a92 data-v-90f83487><!--[--><div class="container" data-v-90f83487><p class="message" data-v-90f83487>Power by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-BN15cZ7s.js" defer></script></body></html>